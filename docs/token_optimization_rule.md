# Astro项目文档生成与Token优化规则

## 1. 组件化与结构优化
（略，见前述内容）

## 2. 分阶段生成与占位符策略
（略，见前述内容）

## 3. 复用与引用
（略，见前述内容）

## 4. 交互与反馈（重点：Interactive-Feedback-MCP）

### 4.1 工具简介
- **Interactive-Feedback-MCP** 是一款专为AI文档/代码生成场景设计的交互式反馈服务器，支持人机协作、逐步确认、节省无效请求。
- 通过MCP协议与Cursor等AI助手集成，实现"每次重要生成/变更后，自动弹窗请求用户确认"，避免反复生成和token浪费。

### 4.2 安装与配置（Windows）
- 详见 `interactive-feedback-mcp/INSTALL_WIN.md`，一键完成环境清理、依赖安装、服务启动。
- 启动命令示例：
  ```powershell
  uv run --active C:/2025Investing/astro-notebook0629/interactive-feedback-mcp/server.py
  ```
- Cursor中注册MCP，类型选 `stdio`，命令路径用绝对路径。

### 4.3 高效用法与节省原理
- **分阶段生成+MCP确认**：每次只生成一小节或结构，生成后通过MCP弹窗让用户确认，确认无误再进入下一步，避免大段返工。
- **交互式反馈**：用户可直接在弹窗中提出修改建议，AI助手据此精准增量编辑，极大减少无效token消耗。
- **自动化链路**：结合项目规则，AI助手每次生成/修改/重构后，自动调用MCP，确保每一步都可控、可追溯。

### 4.4 推荐工作流
1. 规划结构，先生成目录和frontmatter。
2. 逐节生成内容，每节后MCP弹窗确认。
3. 补充图表/代码/数据等占位符，后续单独生成。
4. 章节全部通过MCP确认后，再整体优化样式和交互。

### 4.5 典型节省效果
- 单次生成token消耗降低40%+
- 返工率下降80%+
- 用户满意度和内容质量显著提升

---

> 结合Interactive-Feedback-MCP，可实现"高质量、低token消耗、强可控"的AI文档生成全流程。 