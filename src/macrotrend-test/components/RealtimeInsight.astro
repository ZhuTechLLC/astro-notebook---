---
import { readFile } from "fs/promises";
import path from "path";

const { topic } = Astro.props;

let data = {
  title: "æš‚æ— æ•°æ®",
  date: "",
  summary: "",
  suggestion: "",
  chartUrl: "",
  sources: []
};

try {
  const filePath = path.resolve("src/content/realtime", `${topic}.json`);
  const content = await readFile(filePath, "utf-8");
  data = JSON.parse(content);
} catch (e) {
  data.summary = "âš ï¸ æ— æ³•åŠ è½½å®æ—¶æ•°æ®ã€‚";
}
---

<div class="border p-4 rounded-xl shadow my-6 bg-white">
  <h3 class="text-xl font-bold mb-2">ğŸ“ˆ {data.title}ï¼ˆ{data.date}ï¼‰</h3>
  <p class="text-base mb-3">{data.summary}</p>

  {data.chartUrl && <img src={data.chartUrl} alt="å®è§‚è¶‹åŠ¿å›¾" class="mb-3 rounded-lg w-full" />}

  {data.sources.length > 0 && (
    <ul class="text-sm text-blue-600 list-disc ml-6 mb-3">
      {data.sources.map(src => <li><a href={src} target="_blank">{src}</a></li>)}
    </ul>
  )}

  <div class="bg-yellow-100 p-3 rounded">
    <strong>æŠ•èµ„å»ºè®®ï¼š</strong> {data.suggestion}
  </div>
</div>
